<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registered Accounts Comparison</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Apply a fallback font and ensure the page is always 100% height */
        html, body {
            height: 100%;
            font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
        }
    </style>
</head>
<body class="bg-[#003366] min-h-screen flex flex-col items-center px-[10px] py-[4px]">

    <a href="https://speedofsachi.github.io/FinanceTools/Home.html#" class="absolute top-4 left-4 
        bg-gray-500 hover:bg-gray-600 text-white font-semibold 
        py-2 px-4 rounded-lg shadow-md 
        transition duration-150 ease-in-out z-10">
        Home
    </a>
    <h1 class="text-white text-center text-3xl sm:text-4xl mt-16 mb-6 md:text-6xl mt-16 mb-6 lg:text-[70px] mt-12 mb-6">
        Registered Accounts Compare
    </h1>

  <form class="w-full max-w-2xl bg-gray-100 text-gray-800 rounded-xl shadow-2xl p-8 md:p-12" onsubmit="return false;">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-6">
        
        <div>
            <label for="account1" class="block text-sm font-medium text-gray-700 mb-1">Account 1</label>
            <select id="account1" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                <option value="RRSP">RRSP</option>
                <option value="TFSA">TFSA</option>
                <option value="Margin">Margin</option>
            </select>
        </div>

        <div>
            <label for="account2" class="block text-sm font-medium text-gray-700 mb-1">Account 2</label>
            <select id="account2" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                <option value="RRSP">RRSP</option>
                <option value="TFSA">TFSA</option>
                <option value="Margin">Margin</option>
            </select>
        </div>

        <div>
            <label for="balance" class="block text-sm font-medium text-gray-700 mb-1">Balance ($)</label>
            <input type="number" id="balance" step="0.01" value="10000" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
        </div>
        
        <div>
            <label for="taxRateStart" class="block text-sm font-medium text-gray-700 mb-1">Marginal Tax Rate Start (%)</label>
            <input type="number" id="taxRateStart" step="0.01" value="50" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
        </div>

        <div>
            <label for="divTaxRate" class="block text-sm font-medium text-gray-700 mb-1">Dividend Tax Rate (%)</label>
            <input type="number" id="divTaxRate" step="0.01" value="34.47" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
        </div>

        <div>
            <label for="taxRateEnd" class="block text-sm font-medium text-gray-700 mb-1">Marginal Tax Rate End (%)</label>
            <input type="number" id="taxRateEnd" step="0.01" value="40" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
        </div>

        <div>
            <label for="divYield" class="block text-sm font-medium text-gray-700 mb-1">Dividend Yield (%)</label>
            <input type="number" id="divYield" step="0.01" value="3" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
        </div>

        <div>
            <label for="capitalReturn" class="block text-sm font-medium text-gray-700 mb-1">Capital Return (%)</label>
            <input type="number" id="capitalReturn" step="0.01" value="6" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
        </div>

        <div class="md:col-span-2 mt-4">
            <button type="button" id="calculateBtn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-md shadow-lg transition duration-300 transform hover:scale-105">
                Calculate
            </button>
        </div>

    </div>
</form>

   <div id="result" class="mt-12 w-full max-w-4xl grid grid-cols-1 sm:grid-cols-3 gap-y-8 sm:gap-4 text-center">

        <div class="flex flex-col items-center justify-center">
            <h2 class="text-xl font-medium text-gray-300">Account 1 Balance</h2>
            <p id="account1BalanceOutput" class="text-4xl font-bold text-white mt-2">$0.00</p>
        </div>

        <div class="flex flex-col items-center justify-center">
            <h2 class="text-xl font-medium text-gray-300">Account 2 Balance</h2>
            <p id="account2BalanceOutput" class="text-4xl font-bold text-white mt-2">0</p>
        </div>

        <div class="flex flex-col items-center justify-center">
            <h2 class="text-xl font-medium text-gray-300">Dfiference</h2>
            <p id="differenceOutput" class="text-4xl font-bold text-white mt-2">$0.00</p>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            let balanceEl = document.getElementById('balance'); 
            let taxRateStartEl = document.getElementById('taxRateStart'); 
            let taxRateEndEl = document.getElementById('taxRateEnd'); 
            let account1El = document.getElementById('account1');
            let account2El = document.getElementById('account2');
            let divTaxRateEl = document.getElementById('divTaxRate'); 
            let divYieldEl = document.getElementById('divYield'); 
            let capitalReturnEl = document.getElementById('capitalReturn'); 
            let calculateBtn = document.getElementById('calculateBtn');
            
            // Updated output element IDs
            let account2BalanceOutputEl = document.getElementById('account2BalanceOutput'); // New
            let account1BalanceOutputEl = document.getElementById('account1BalanceOutput'); // Renamed/Replaced
            let differenceOutputEl = document.getElementById('differenceOutput'); // New

            /**
             * Calculates the payment, total periods, and total interest.
             */
            function calculateMortgageMetrics() {
                // Get and parse all values
                let balance = parseFloat(balanceEl.value) || 0; 
                let taxRateStart = (parseFloat(taxRateStartEl.value) || 0) / 100;
                let taxRateEnd = (parseFloat(taxRateEndEl.value) || 0) / 100;
                let frequency = account1El.value;
                let frequencyAnn = 0;
                let divTaxRateYears = parseFloat(divTaxRateEl.value) || 0; 
                
                // Mortgage Variables
                let totalPeriods = Math.floor(divTaxRateYears * frequencyAnn);
                let periodicRate1 = taxRateStart / frequencyAnn;
                let periodicRate2 = taxRateEnd / frequencyAnn;
                let periodicPayment1 = 0;
                let periodicPayment2 = 0;
                let totalInterest1 = 0;
                let totalInterest2 = 0;
                let periodicPaymentSavings = 0;
                let difference = 0;
                let totalSavingsPV = 0;

                // Calculate Mortgage 1
                if (totalPeriods === 0) {
                   periodicPayment1 = balance
                   totalInterest1 = 0
                } else if (periodicRate1 === 0) {
                   periodicPayment1 = balance / totalPeriods
                   totalInterest1 = 0
                } else {
                   periodicPayment1 = balance* periodicRate1 / (1 - (1 + periodicRate1)**(-totalPeriods))
                   totalInterest1 = periodicPayment1 * totalPeriods - balance
                }

                // Calculate Mortgage 2
                if (totalPeriods === 0) {
                   periodicPayment2 = balance
                   totalInterest2 = 0
                } else if (periodicRate2 === 0) {
                   periodicPayment2 = balance / totalPeriods
                   totalInterest2 = 0
                } else {
                   periodicPayment2 = balance* periodicRate2 / (1 - (1 + periodicRate2)**(-totalPeriods))
                   totalInterest2 = periodicPayment2 * totalPeriods - balance
                }

                // Calculate Savings
                difference = Math.abs(totalInterest1 - totalInterest2)
                periodicPaymentSavings = Math.abs(periodicPayment1 - periodicPayment2)
                if (taxRateStart > taxRateEnd) {
                   if (taxRateEnd === 0) {
                      totalSavingsPV = periodicPayment1 * totalPeriods - balance
                   } else {
                      totalSavingsPV = periodicPayment1 * (1 - (1 + periodicRate2)**(-totalPeriods)) / periodicRate2 - balance
                   }
                } else if (taxRateEnd > taxRateStart) {
                   if (taxRateStart === 0) {
                      totalSavingsPV = periodicPayment2 * totalPeriods - balance
                   } else {
                      totalSavingsPV = periodicPayment2 * (1 - (1 + periodicRate1)**(-totalPeriods)) / periodicRate1 - balance
                   }
                } else {
                   totalSavingsPV = 0
                }

                // --- Display Results ---

                // 1. Period Payment Savings
                account1BalanceOutputEl.textContent = periodicPaymentSavings.toLocaleString('en-US', {
                    style: 'currency',
                    currency: 'USD',
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                 });

                // 2. Dfiference
                differenceOutputEl.textContent = difference.toLocaleString('en-US', {
                   style: 'currency',
                   currency: 'USD',
                   minimumFractionDigits: 2,
                   maximumFractionDigits: 2
                });

                // 3. Total Interest (Currency)
                account2BalanceOutputEl.textContent = totalSavingsPV.toLocaleString('en-US', {
                   style: 'currency',
                   currency: 'USD',
                   minimumFractionDigits: 2,
                   maximumFractionDigits: 2
                });
            }

            // --- Event Listeners ---
            calculateBtn.addEventListener('click', calculateMortgageMetrics);

        });
    </script>

</body>
</html>